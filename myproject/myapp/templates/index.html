<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}ORMOC LGU ATTENDANCE{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'css/chatbot.css' %}">
    <link rel="stylesheet" href="{% static 'css/notifs.css' %}">
   
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
<!-- Bootstrap JS -->

   

     <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    /> 
  </head>
  <body>
    <section class="sidebar">
      


      <nav>
        {% block nav_content %}
        <!-- Default content for nav, can be overridden -->
        {% endblock %}
      </nav>



      <div class="nav-header">
        <p class="logo"> ATTENDANCE</p>
        <i style="display:none;" class="bx bx-menu btn-menu"></i>
      </div>
      <ul class="nav-links">
        {% url 'admin_dashboard' as admin_dashboard_url %}
        {% url 'departments' as departments_url %}
        {% url 'employeelist' as employeelist_url %}
        {% url 'logout' as logout_url %}
        {% url 'schedule_list' as custom_url %}
        {% url 'attendance' as attendance %}
        {% url 'settings' as settings %}


      
        <li class="{% if request.path == admin_dashboard_url %}active{% endif %}">
            <a href="{{ admin_dashboard_url }}">
                <i class="bx bx-home-alt-2"></i>
                <span class="title">Home</span>
            </a>
            <span class="tooltip">Home</span>
        </li>

        <li class="{% if request.path == attendance %}active{% endif %}">
          <a href="{{ attendance }}">
              <i class="bx bx-calendar"></i>
              <span class="title">attendance Records</span>
          </a>
          <span class="tooltip">Log out</span>
      </li>

        <li class="{% if request.path == departments_url %}active{% endif %}">
            <a href="{{ departments_url }}">
                <i class="bx bx-network-chart"></i>
                <span class="title">Departments</span>
            </a>
            <span class="tooltip">Departments</span>
        </li>
        <li class="{% if request.path == employeelist_url %}active{% endif %}">
            <a href="{{ employeelist_url }}">
                <i class="bx bx-user"></i>
                <span class="title">Employee List</span>
            </a>
            <span class="tooltip">Employee List</span>
        </li>
        
        <li class="{% if request.path == custom_url %}active{% endif %}">
          <a href="{{ custom_url }}">
              <i class="bx bxs-calendar-event "></i>
              <span class="title">Events</span>
          </a>
          <span class="tooltip">Log out</span>
      </li>
      
      <li class="{% if request.path == settings %}active{% endif %}">
        <a href="{{ settings }}">
            <i class="bx bx-time"></i>
            <span class="title">Time Settings</span>
        </a>
        <span class="tooltip"></span>
    </li>

        <li class="{% if request.path == logout_url %}active{% endif %}">
            <a href="{{ logout_url }}">
                <i class="bx bx-reply"></i>
                <span class="title">Log out</span>
            </a>
            <span class="tooltip">Log out</span>
        </li>
        
        

      </ul>
      
      {% comment %}
        <li>
            <a href="{% url 'reports' %}">
            <i class="bx bx-envelope"></i>
            <span class="title">Reports</span>
          </a>
          <span class="tooltip">Reports</span>
        </li> {% endcomment %}
        {% comment %} <li>
          <a href="{% url 'logout' %}">
            <i class="bx bx-reply"></i>
            <span class="title">Log out</span>
          </a>
          <span class="tooltip">Log out</span>
        </li>
      </ul> {% endcomment %}
       <div class="theme-wrapper">
        <i class="bx bxs-moon theme-icon"></i>
        <p>Dark Theme</p>
        <div class="theme-btn">
          <span class="theme-ball"></span>
        </div>
      </div> 
      
    </section>
   
     {% block content %}
 

 
    {% endblock %}



    <script>
      // Select the menu button and sidebar
      const btn_menu = document.querySelector(".btn-menu");
      const side_bar = document.querySelector(".sidebar");
  
      // Function to make sidebar static (expanded)
      function makeSidebarStatic() {
          side_bar.classList.add("expand"); // Ensure sidebar is expanded
          btn_menu.classList.replace("bx-menu", "bx-menu-alt-right"); // Change button icon
      }
  
      // Call the function to set sidebar state on page load
      makeSidebarStatic();
  
      const btn_theme = document.querySelector(".theme-btn");
      const theme_ball = document.querySelector(".theme-ball");
  
      const localData = localStorage.getItem("theme");
  
      if (localData == null) {
          localStorage.setItem("theme", "light");
      }
  
      if (localData == "dark") {
          document.body.classList.add("dark-mode");
          theme_ball.classList.add("dark");
      } else if (localData == "light") {
          document.body.classList.remove("dark-mode");
          theme_ball.classList.remove("dark");
      }
  
      btn_theme.addEventListener("click", function () {
          document.body.classList.toggle("dark-mode");
          theme_ball.classList.toggle("dark");
          if (document.body.classList.contains("dark-mode")) {
              localStorage.setItem("theme", "dark");
          } else {
              localStorage.setItem("theme", "light");
          }
      });
  </script>





     <!-- Chatbot Toggle Button -->
<button id="toggleChatbot">
   <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-robot" viewBox="0 0 16 16">
  <path d="M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5M3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.6 26.6 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.93.93 0 0 1-.765.935c-.845.147-2.34.346-4.235.346s-3.39-.2-4.235-.346A.93.93 0 0 1 3 9.219zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a25 25 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25 25 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135"/>
  <path d="M8.5 1.866a1 1 0 1 0-1 0V3h-2A4.5 4.5 0 0 0 1 7.5V8a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1v-.5A4.5 4.5 0 0 0 10.5 3h-2zM14 7.5V13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.5A3.5 3.5 0 0 1 5.5 4h5A3.5 3.5 0 0 1 14 7.5"/>
</svg>
</button>


<!-- Chatbot Container -->
<div id="chatbotContainer" style="display: none;">
  <!-- Close Button (Ã—) -->
  <button id="closeChatbot" >&times;</button>

  <div id="chatbox"></div>

  <!-- Quick Reply Buttons -->
  <hr style="border-top: 10px solid black">
  <div id="quickRepliesContainer">
      <div id="quickReplies">
          <!-- Quick reply buttons will be added dynamically here -->
      </div>
  </div>
</div>


  
 
     <!-- JavaScript -->
     <script>

      document.getElementById('closeChatbot').addEventListener('click', function () {
        // Hide the chatbot container
        document.getElementById('chatbotContainer').style.display = 'none';
        // Optionally, clear the chatbox and quick replies when closing
        document.getElementById('chatbox').innerHTML = '';
        document.getElementById('quickReplies').innerHTML = '';
    });

    

      document.getElementById('toggleChatbot').addEventListener('click', function () {
        let chatbotContainer = document.getElementById('chatbotContainer');
        if (chatbotContainer.style.display === 'none' || chatbotContainer.style.display === '') {
            chatbotContainer.style.display = 'flex';
    
            // Add initial bot message and quick replies
            let message = "Hi! I'm FAQ support. You can ask me questions by clicking the buttons below:";
            let options = 
            [
              "What types of data does the system record?",
              "Does the system track late arrivals?",
              "how to see specific employee records?",
              "how to add a new employee?",
              "How does events work?",
              "how to export employees record?",
              "How to change the employee's password?",
              "How to change overtime duration?",
              "Bye"
               ];
            displayMessage(message, 'bot');
            displayQuickReplies(options);
        } else {
            chatbotContainer.style.display = 'none';
            document.getElementById('chatbox').innerHTML = '';
            document.getElementById('quickReplies').innerHTML = '';
        }
    });
    
    document.getElementById('quickReplies').addEventListener('click', function (event) {
        if (event.target.classList.contains('quick-reply')) {
            let userInput = event.target.textContent; // Get the text of the clicked button
            displayMessage(userInput, 'user');
            let response = getResponse(userInput);
            displayMessage(response, 'bot');
    
            // Optionally, clear and add new quick replies based on the context
            if (userInput === "Bye") {
                document.getElementById('quickReplies').innerHTML = ''; // Clear replies
            }
        }
    });
    
    function displayMessage(message, sender) {
        let chatbox = document.getElementById('chatbox');
        let messageElement = document.createElement('div');
        messageElement.className = `message ${sender}`;
        messageElement.textContent = message;
        chatbox.appendChild(messageElement);
        chatbox.scrollTop = chatbox.scrollHeight; // Scroll to the bottom
    }
    
    function displayQuickReplies(options) {
        let quickReplies = document.getElementById('quickReplies');
        quickReplies.innerHTML = ''; // Clear existing replies
    
        options.forEach(option => {
            let button = document.createElement('button');
            button.className = 'quick-reply';
            button.textContent = option;
            quickReplies.appendChild(button);
        });
    }
    
    function getResponse(input) {
        const responses = {
            "What types of data does the system record?": "Time-in and time-out logs, Attendance summaries for payroll purposes",
            "Does the system track late arrivals?": "Yes, the system flags late arrivals and calculates deductions or penalties as per government policies.",
            "how to see specific employee records?": "Click employee list in the side bar and click the records button",
            "how to add a new employee?": "to add new employee, click the employee list in the side bar and click the add employee button, fill-up the form.",
            "How does events work?": "If an event is happening today, the attendance time-in and time-out will vary accordingly. The time-out will occur halfway between the time-in and the time-out.",
            "how to export employees record?": "To export an employee's record, go to the employee list and click the Records button for the employee whose record you want to export. Then, click the Export as PDF button.",
            "How to change the employee's password?": "Go to employee list and click the edit button, then type the new password in the form provided.",
            "How to change overtime duration?": "Go to Custom Adjustments and click the Change Overtime Duration button",
            "Bye": "Goodbye! Have a great day!"
        };
    
        return responses[input] || "I'm not sure how to respond to that.";
    }
    
     </script>




  </body>
</html>